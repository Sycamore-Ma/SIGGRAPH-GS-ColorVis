import matplotlib.pyplot as plt
import numpy as np
import sys
import pprint
import matplotlib.colors as mcolors

def normalize_rgb(rgb):
    max_val = max(rgb)
    if max_val == 0:
        return rgb
    return tuple(c / max_val for c in rgb)


def generate_colors(n):
    base_colors = [
        (0.984313725490196, 0.7058823529411765, 0.6823529411764706),
        (0.7019607843137254, 0.803921568627451, 0.8901960784313725),
        (0.8, 0.9215686274509803, 0.7725490196078432),
        (0.8705882352941177, 0.796078431372549, 0.8941176470588236),
        (0.996078431372549, 0.8509803921568627, 0.6509803921568628),
        (1.0, 1.0, 0.8),
        (0.8980392156862745, 0.8470588235294118, 0.7411764705882353),
        (0.9921568627450981, 0.8549019607843137, 0.9254901960784314),
        (0.9490196078431372, 0.9490196078431372, 0.9490196078431372),
        (0.7019607843137254, 0.8862745098039215, 0.803921568627451),
        (0.9921568627450981, 0.803921568627451, 0.6745098039215687),
        (0.796078431372549, 0.8352941176470589, 0.9098039215686274),
        (0.9568627450980393, 0.792156862745098, 0.8941176470588236),
        (0.9019607843137255, 0.9607843137254902, 0.788235294117647),
        (1.0, 0.9490196078431372, 0.6823529411764706),
        (0.9450980392156862, 0.8862745098039215, 0.8),
        (0.8, 0.8, 0.8),
        (0.5529411764705883, 0.8274509803921568, 0.7803921568627451),
        (1.0, 1.0, 0.7019607843137254),
        (0.7450980392156863, 0.7294117647058823, 0.8549019607843137),
        (0.984313725490196, 0.5019607843137255, 0.4470588235294118),
        (0.5019607843137255, 0.6941176470588235, 0.8274509803921568),
        (0.9921568627450981, 0.7058823529411765, 0.3843137254901961),
        (0.7019607843137254, 0.8705882352941177, 0.4117647058823529),
        (0.9882352941176471, 0.803921568627451, 0.8980392156862745),
        (0.8509803921568627, 0.8509803921568627, 0.8509803921568627),
        (0.7372549019607844, 0.5019607843137255, 0.7411764705882353),
        (0.8, 0.9215686274509803, 0.7725490196078432),
        (1.0, 0.9294117647058824, 0.43529411764705883),
        (0.7, 0.8, 0.9)
    ]

    print(f"[Base Colors] ({len(base_colors)} colors):")
    for i, c in enumerate(base_colors):
        print(f"  {i:2d}: {c}")

    k = len(base_colors)
    if n <= k:
        return base_colors[:n]

    # 亮度递减因子
    rounds = (n + k - 1) // k
    brightness_factors = np.linspace(1.0, 0.9, rounds)

    # 多轮生成颜色，每轮统一缩放亮度
    result = []
    for r in range(rounds):
        for i in range(k):
            if len(result) >= n:
                break
            base = np.array(base_colors[i])
            # color = np.clip(base * brightness_factors[r], 0, 1)
            # result.append(tuple(color))
            
            if r != 0:
                # # 缩放亮度
                # scaled = base * brightness_factors[r]
                # # 再归一化（防止整体发灰）
                # color = normalize_rgb(np.clip(scaled, 0, 1))            
                color = np.clip(base * brightness_factors[r], 0, 1)
            else:
                # 第一轮不缩放亮度
                color = base
            
            result.append(color)

    return result

if __name__ == '__main__':
    if len(sys.argv) < 2:
        print("Usage: python color_generator.py <num_colors>")
        sys.exit(1)

    num_colors = int(sys.argv[1])
    color_list = generate_colors(num_colors)
    pprint.pprint(color_list)
